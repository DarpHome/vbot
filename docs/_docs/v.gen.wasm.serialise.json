{"module_name":"v.gen.wasm.serialise","description":"","contents":[{"attributes":{},"comments":[],"children":[{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\v\\gen\\wasm\\serialise\\serialise.v","content":"fn (mut p Pool) type_struct_info(typ ast.Type) ?StructInfo","name":"type_struct_info","parent_name":"Pool","return_type":"?StructInfo","pos":{"len":62,"line_nr":43,"pos":677,"col":0,"last_line":57},"platform":"cross","kind":"method","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\v\\gen\\wasm\\serialise\\serialise.v","content":"fn (mut p Pool) type_size(typ ast.Type) (int, int)","name":"type_size","parent_name":"Pool","return_type":"(int, int)","pos":{"len":54,"line_nr":59,"pos":961,"col":0,"last_line":101},"platform":"cross","kind":"method","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\v\\gen\\wasm\\serialise\\serialise.v","content":"fn (mut p Pool) append_string(val string) int","name":"append_string","parent_name":"Pool","return_type":"int","pos":{"len":49,"line_nr":270,"pos":5001,"col":0,"last_line":298},"platform":"cross","kind":"method","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\v\\gen\\wasm\\serialise\\serialise.v","content":"fn (mut p Pool) append(init ast.Expr, typ ast.Type) (int, bool)","name":"append","parent_name":"Pool","return_type":"(int, bool)","pos":{"len":67,"line_nr":300,"pos":5507,"col":0,"last_line":392},"platform":"cross","kind":"method","public":true,"from_scope":false}],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\v\\gen\\wasm\\serialise\\serialise.v","content":"struct Pool {\nmut:\n\ttable &ast.Table\n\t// eval    eval.Eval\n\tstructs map[ast.Type]StructInfo\n\tstrings []StringInfo // string intern\npub:\n\tnull_terminated bool\n\tintern_strings  bool\n\tstore_relocs    bool\npub mut:\n\tbuf               []u8\n\trelocs            []Reloc\n\thighest_alignment int\n}","name":"Pool","parent_name":"","return_type":"","pos":{"len":15,"line_nr":11,"pos":242,"col":0,"last_line":25},"platform":"cross","kind":"struct_","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\v\\gen\\wasm\\serialise\\serialise.v","content":"struct StructInfo {\npub mut:\n\toffsets []int\n}","name":"StructInfo","parent_name":"","return_type":"","pos":{"len":21,"line_nr":32,"pos":575,"col":0,"last_line":35},"platform":"cross","kind":"struct_","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\v\\gen\\wasm\\serialise\\serialise.v","content":"struct Reloc {\npub:\n\tpos    int\n\toffset int\n}","name":"Reloc","parent_name":"","return_type":"","pos":{"len":16,"line_nr":37,"pos":626,"col":0,"last_line":41},"platform":"cross","kind":"struct_","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\v\\gen\\wasm\\serialise\\serialise.v","content":"struct PoolOpts {\n\tnull_terminated bool = true\n\tintern_strings  bool = true\n\tstore_relocs    bool = true\n}","name":"PoolOpts","parent_name":"","return_type":"","pos":{"len":19,"line_nr":104,"pos":1854,"col":0,"last_line":108},"platform":"cross","kind":"struct_","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\v\\gen\\wasm\\serialise\\serialise.v","content":"fn new_pool(table &ast.Table, opts PoolOpts) Pool","name":"new_pool","parent_name":"","return_type":"Pool","pos":{"len":53,"line_nr":110,"pos":1966,"col":0,"last_line":117},"platform":"cross","kind":"function","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\nfn (mut p Pool) append_struct(init ast.StructInit) ?int {\n\told_len := p.buf.len\n\n\tsize, align := p.type_size(v.typ)\n\tts := g.table.sym(v.typ)\n\tts_info := ts.info as ast.Struct\n\n\tpos := p.alignment(align)\n\t\n\tif init.fields.len == 0 && !(ts_info.fields.any(it.has_default_expr)) {\n\t\tfor i := 0 ; i < size ; i++ {\n\t\t\tp.buf << 0\n\t\t}\n\t\treturn pos\n\t}\n\n\t/* for i, f in ts_info.fields {\n\t\tfield_to_be_set := init.fields.map(it.name).filter(f.name)\n\t} */\n\n\t/* for i, f in ts_info.fields {\n\t\tfield_to_be_set := init.fields.map(it.name).contains(f.name)\n\n\t\tif !field_to_be_set {\n\t\t\toffset := g.structs[v.typ.idx()].offsets[i]\n\t\t\toffset_var := g.offset(v, f.typ, offset)\n\n\t\t\tfsize, _ := g.get_type_size_align(f.typ)\n\t\t\t\n\t\t\tif f.has_default_expr {\n\t\t\t\tg.expr(f.default_expr, f.typ)\n\t\t\t\tg.set(offset_var)\n\t\t\t} else {\n\t\t\t\tg.zero_fill(offset_var, fsize)\n\t\t\t}\t\t\t\t\t\t\n\t\t}\n\t}\n\n\tfor f in init.fields {\n\t\tfield := ts.find_field(f.name) or {\n\t\t\tg.w_error('could not find field `${f.name}` on init')\n\t\t}\n\t\t\n\t\toffset := g.structs[v.typ.idx()].offsets[field.i]\n\t\toffset_var := g.offset(v, f.expected_type, offset)\n\n\t\tg.expr(f.expr, f.expected_type)\n\t\tg.set(offset_var)\n\t} */\n\n\treturn pos\n}","is_multi":true,"pos":{"len":1164,"line_nr":137,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\v\\gen\\wasm\\serialise\\serialise.v","content":"fn eval_escape_codes_raw(str string) !string","name":"eval_escape_codes_raw","parent_name":"","return_type":"!string","pos":{"len":48,"line_nr":191,"pos":3699,"col":0,"last_line":260},"platform":"cross","kind":"function","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\v\\gen\\wasm\\serialise\\serialise.v","content":"fn eval_escape_codes(str_lit ast.StringLiteral) !string","name":"eval_escape_codes","parent_name":"","return_type":"!string","pos":{"len":59,"line_nr":262,"pos":4847,"col":0,"last_line":268},"platform":"cross","kind":"function","public":true,"from_scope":false}],"generator":"vdoc","time_generated":"2024-01-13 21:06:42"}