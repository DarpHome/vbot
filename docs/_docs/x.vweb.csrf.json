{"module_name":"x.vweb.csrf","contents":[{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\x\\vweb\\csrf\\csrf.v","content":"struct CsrfConfig {\npub:\n\tsecret string\n\t// how long the random part of the csrf-token should be\n\tnonce_length int = 64\n\t// HTTP \"safe\" methods meaning they shouldn't alter state.\n\t// If a request with any of these methods is made, `protect` will always return true\n\t// https://datatracker.ietf.org/doc/html/rfc7231#section-4.2.1\n\tsafe_methods []http.Method = [.get, .head, .options]\n\t// which hosts are allowed, enforced by checking the Origin and Referer header\n\t// if allowed_hosts contains '*' the check will be skipped.\n\t// Subdomains need to be included separately: a request from `\"sub.example.com\"`\n\t//  will be rejected when `allowed_host = ['example.com']`.\n\tallowed_hosts []string\n\t// if set to true both the Referer and Origin headers must match `allowed_hosts`\n\t// else if either one is valid the request is accepted\n\tcheck_origin_and_referer bool = true\n\t// the name of the csrf-token in the hidden html input\n\ttoken_name string = 'csrftoken'\n\t// the name of the cookie that contains the session id\n\tsession_cookie string\n\t// cookie options\n\tcookie_name string        = 'csrftoken'\n\tsame_site   http.SameSite = .same_site_strict_mode\n\tcookie_path string        = '/'\n\t// how long the cookie stays valid in seconds. Default is 30 days\n\tmax_age       int = 60 * 60 * 24 * 30\n\tcookie_domain string\n\t// whether the cookie can be send only over HTTPS\n\tsecure bool\n}","name":"CsrfConfig","parent_name":"","return_type":"","pos":{"len":21,"line_nr":12,"pos":159,"col":0,"last_line":42},"platform":"cross","kind":"struct_","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[{"attributes":{},"comments":[{"text":"\u0001 set_token generates a new csrf_token and adds a Cookie to the response","is_multi":false,"pos":{"len":72,"line_nr":52,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\x\\vweb\\csrf\\csrf.v","content":"fn (mut ctx CsrfContext) set_csrf_token[T](mut user_context T) string","name":"set_csrf_token","parent_name":"CsrfContext","return_type":"string","pos":{"len":73,"line_nr":53,"pos":1757,"col":0,"last_line":56},"platform":"cross","kind":"method","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\u0001 clear the csrf token and cookie header from the context","is_multi":false,"pos":{"len":57,"line_nr":58,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\x\\vweb\\csrf\\csrf.v","content":"fn (ctx &CsrfContext) clear_csrf_token[T](mut user_context T)","name":"clear_csrf_token","parent_name":"CsrfContext","return_type":"void","pos":{"len":65,"line_nr":59,"pos":1976,"col":0,"last_line":65},"platform":"cross","kind":"method","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\u0001 csrf_token_input returns an HTML hidden input containing the csrf token","is_multi":false,"pos":{"len":73,"line_nr":67,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\x\\vweb\\csrf\\csrf.v","content":"fn (ctx &CsrfContext) csrf_token_input() vweb.RawHtml","name":"csrf_token_input","parent_name":"CsrfContext","return_type":"x.vweb.RawHtml","pos":{"len":57,"line_nr":68,"pos":2216,"col":0,"last_line":70},"platform":"cross","kind":"method","public":true,"from_scope":false}],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\x\\vweb\\csrf\\csrf.v","content":"struct CsrfContext {\npub mut:\n\tconfig CsrfConfig\n\texempt bool\n\t// the csrftoken that should be placed in an html form\n\tcsrf_token string\n}","name":"CsrfContext","parent_name":"","return_type":"","pos":{"len":22,"line_nr":44,"pos":1539,"col":0,"last_line":50},"platform":"cross","kind":"struct_","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\u0001 middleware returns a handler that you can use with vweb's middleware","is_multi":false,"pos":{"len":70,"line_nr":72,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\x\\vweb\\csrf\\csrf.v","content":"fn middleware[T](config CsrfConfig) vweb.MiddlewareOptions[T]","name":"middleware","parent_name":"","return_type":"x.vweb.MiddlewareOptions[T]","pos":{"len":65,"line_nr":73,"pos":2441,"col":0,"last_line":87},"platform":"cross","kind":"function","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\u0001 set_token returns the csrftoken and sets an encrypted cookie with the hmac of","is_multi":false,"pos":{"len":79,"line_nr":89,"pos":0,"col":0,"last_line":0}},{"text":"\u0001 `config.get_secret` and the csrftoken","is_multi":false,"pos":{"len":39,"line_nr":90,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\x\\vweb\\csrf\\csrf.v","content":"fn set_token(mut ctx vweb.Context, config &CsrfConfig) string","name":"set_token","parent_name":"","return_type":"string","pos":{"len":65,"line_nr":91,"pos":2916,"col":0,"last_line":112},"platform":"cross","kind":"function","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\u0001 protect returns false and sends an http 401 response when the csrf verification","is_multi":false,"pos":{"len":81,"line_nr":114,"pos":0,"col":0,"last_line":0}},{"text":"\u0001 fails. protect will always return true if the current request method is in","is_multi":false,"pos":{"len":76,"line_nr":115,"pos":0,"col":0,"last_line":0}},{"text":"\u0001 `config.safe_methods`.","is_multi":false,"pos":{"len":24,"line_nr":116,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\x\\vweb\\csrf\\csrf.v","content":"fn protect(mut ctx vweb.Context, config &CsrfConfig) bool","name":"protect","parent_name":"","return_type":"bool","pos":{"len":61,"line_nr":117,"pos":3796,"col":0,"last_line":177},"platform":"cross","kind":"function","public":true,"from_scope":false}],"generator":"vdoc","time_generated":"2024-02-05 19:45:44"}