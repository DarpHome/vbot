{"module_name":"db.mssql","description":"# SQL Server ODBC\n\n* This is a V wrapper of SQL Server ODBC C/C++ library\n\n## Dependencies\n* ODBC C/C++ library * Linux Install: * Details: https://docs.microsoft.com/en-us/sql/connect/odbc/linux-mac/installing-the-microsoft-odbc-driver-for-sql-server * `msodbcsql17` and `unixodbc-dev` packages are needed * Windows Install: * `odbc` lib is included in windows sdk for most of distributions, so there is no need to install it separately * Details: https://docs.microsoft.com/en-us/sql/connect/odbc/microsoft-odbc-driver-for-sql-server\n\n## Windows Notes\n### Using `msvc`\n* Make sure `cl.exe` of `msvc` is accessible from command line. You can run `v` commands in `Visual Studio 2019 Developer Command Prompt` to be safe. * C Headers and dlls can be automatically resolved by `msvc`.### Using `tcc`\n* Copy those headers to `@VEXEROOT\thirdparty\mssql\include`. The version number `10.0.18362.0` might differ on your system. Command Prompt commands:\n```cmd\ncopy \"C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\um\sql.h\" thirdparty\mssql\include\ncopy \"C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\um\sqlext.h\" thirdparty\mssql\include\ncopy \"C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\um\sqltypes.h\" thirdparty\mssql\include\ncopy \"C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\um\sqlucode.h\" thirdparty\mssql\include\ncopy \"C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\shared\sal.h\" thirdparty\mssql\include\ncopy \"C:\Program Files (x86)\Windows Kits\10\Include\10.0.18362.0\shared\concurrencysal.h\" thirdparty\mssql\include\n```\n* dlls can be automatically resolved by `tcc`\n\n## TODO\n* Support Mac\n* Support ORM\n\n## Usage\n```v ignore\nimport mssql\n\nfn test_example() ? {\n// connect to server\nconfig := mssql.Config{\ndriver: 'ODBC Driver 17 for SQL Server'\nserver: 'tcp:localhost'\nuid: '<your username>'\npwd: '<your password>'\n}\n\nmut conn := mssql.Connection{}\n\nconn.connect(config.get_conn_str())?\n\ndefer {\nconn.close()\n}\n\n// get current db name\nmut query := 'SELECT DB_NAME()'\nmut res := conn.query(query)?\nassert res == mssql.Result{\nrows: [mssql.Row{\nvals: ['master']\n}]\nnum_rows_affected: -1\n}\n}\n```\n","contents":[{"attributes":{},"comments":[{"text":"\u0001 Config TODO","is_multi":false,"pos":{"len":13,"line_nr":2,"pos":0,"col":0,"last_line":0}}],"children":[{"attributes":{},"comments":[{"text":"\u0001 get_conn_str TODO","is_multi":false,"pos":{"len":19,"line_nr":14,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\db\\mssql\\config.v","content":"fn (cfg Config) get_conn_str() string","name":"get_conn_str","parent_name":"Config","return_type":"string","pos":{"len":41,"line_nr":15,"pos":280,"col":0,"last_line":21},"platform":"cross","kind":"method","public":true,"from_scope":false}],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\db\\mssql\\config.v","content":"struct Config {\npub:\n\tdriver string\n\tserver string\n\tuid    string\n\tpwd    string\n\t// if dbname empty, conn str will not contain Database info,\n\t// and it is up to the server to choose which db to connect to.\n\tdbname string\n}","name":"Config","parent_name":"","return_type":"","pos":{"len":17,"line_nr":3,"pos":29,"col":0,"last_line":12},"platform":"cross","kind":"struct_","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[{"attributes":{},"comments":[{"text":"\u0001 connect to db","is_multi":false,"pos":{"len":15,"line_nr":10,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\db\\mssql\\mssql.c.v","content":"fn (mut conn Connection) connect(conn_str string) !bool","name":"connect","parent_name":"Connection","return_type":"!bool","pos":{"len":59,"line_nr":11,"pos":215,"col":0,"last_line":44},"platform":"cross","kind":"method","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\u0001 close - closes the connection.","is_multi":false,"pos":{"len":32,"line_nr":46,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\db\\mssql\\mssql.c.v","content":"fn (mut conn Connection) close()","name":"close","parent_name":"Connection","return_type":"void","pos":{"len":36,"line_nr":47,"pos":1957,"col":0,"last_line":59},"platform":"cross","kind":"method","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\u0001 query executes a sql query","is_multi":false,"pos":{"len":28,"line_nr":61,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\db\\mssql\\mssql.c.v","content":"fn (mut conn Connection) query(q string) !Result","name":"query","parent_name":"Connection","return_type":"!Result","pos":{"len":52,"line_nr":62,"pos":2419,"col":0,"last_line":87},"platform":"cross","kind":"method","public":true,"from_scope":false}],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\db\\mssql\\mssql.c.v","content":"struct Connection {\nmut:\n\thenv C.SQLHENV = C.SQLHENV(C.SQL_NULL_HENV) // Environment\n\thdbc C.SQLHDBC = C.SQLHDBC(C.SQL_NULL_HDBC) // Connection handle\npub mut:\n\tconn_str string\n}","name":"Connection","parent_name":"","return_type":"","pos":{"len":21,"line_nr":2,"pos":14,"col":0,"last_line":8},"platform":"cross","kind":"struct_","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\db\\mssql\\result.v","content":"struct Row {\npub mut:\n\tvals []string\n}","name":"Row","parent_name":"","return_type":"","pos":{"len":14,"line_nr":2,"pos":14,"col":0,"last_line":5},"platform":"cross","kind":"struct_","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\db\\mssql\\result.v","content":"struct Result {\npub mut:\n\trows []Row\n\t// the number of rows affected by sql statement\n\tnum_rows_affected int\n}","name":"Result","parent_name":"","return_type":"","pos":{"len":17,"line_nr":7,"pos":58,"col":0,"last_line":12},"platform":"cross","kind":"struct_","public":true,"from_scope":false}],"generator":"vdoc","time_generated":"2024-01-13 21:06:32"}