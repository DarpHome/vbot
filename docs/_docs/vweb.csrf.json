{"module_name":"vweb.csrf","contents":[{"attributes":{},"comments":[],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\vweb\\csrf\\csrf.v","content":"struct CsrfConfig {\npub:\n\tsecret string\n\t// how long the random part of the csrf-token should be\n\tnonce_length int = 64\n\t// HTTP \"safe\" methods meaning they shouldn't alter state.\n\t// If a request with any of these methods is made, `protect` will always return true\n\t// https://datatracker.ietf.org/doc/html/rfc7231#section-4.2.1\n\tsafe_methods []http.Method = [.get, .head, .options]\n\t// which hosts are allowed, enforced by checking the Origin and Referer header\n\t// if allowed_hosts contains '*' the check will be skipped.\n\t// Subdomains need to be included separately: a request from `\"sub.example.com\"`\n\t//  will be rejected when `allowed_host = ['example.com']`.\n\tallowed_hosts []string\n\t// if set to true both the Referer and Origin headers must match `allowed_hosts`\n\t// else if either one is valid the request is accepted\n\tcheck_origin_and_referer bool = true\n\t// the name of the csrf-token in the hidden html input\n\ttoken_name string = 'csrftoken'\n\t// the name of the cookie that contains the session id\n\tsession_cookie string\n\t// cookie options\n\tcookie_name string        = 'csrftoken'\n\tsame_site   http.SameSite = .same_site_strict_mode\n\tcookie_path string        = '/'\n\t// how long the cookie stays valid in seconds. Default is 30 days\n\tmax_age       int = 60 * 60 * 24 * 30\n\tcookie_domain string\n}","name":"CsrfConfig","parent_name":"","return_type":"","pos":{"len":21,"line_nr":12,"pos":157,"col":0,"last_line":40},"platform":"cross","kind":"struct_","public":true,"from_scope":false},{"attributes":{},"comments":[],"children":[{"attributes":{},"comments":[{"text":"\u0001 set_token is the app wrapper for `set_token`","is_multi":false,"pos":{"len":46,"line_nr":49,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\vweb\\csrf\\csrf.v","content":"fn (mut app CsrfApp) set_token(mut ctx vweb.Context)","name":"set_token","parent_name":"CsrfApp","return_type":"void","pos":{"len":56,"line_nr":50,"pos":1636,"col":0,"last_line":52},"platform":"cross","kind":"method","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\u0001 protect is the app wrapper for `protect`","is_multi":false,"pos":{"len":42,"line_nr":54,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\vweb\\csrf\\csrf.v","content":"fn (mut app CsrfApp) protect(mut ctx vweb.Context) bool","name":"protect","parent_name":"CsrfApp","return_type":"bool","pos":{"len":59,"line_nr":55,"pos":1790,"col":0,"last_line":57},"platform":"cross","kind":"method","public":true,"from_scope":false}],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\vweb\\csrf\\csrf.v","content":"struct CsrfApp {\n\tCsrfConfig\npub mut:\n\t// the csrftoken that should be placed in an html form\n\ttoken string\n}","name":"CsrfApp","parent_name":"","return_type":"","pos":{"len":18,"line_nr":42,"pos":1473,"col":0,"last_line":47},"platform":"cross","kind":"struct_","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\u0001 middleware returns a function that you can use in `app.middlewares`","is_multi":false,"pos":{"len":69,"line_nr":64,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\vweb\\csrf\\csrf.v","content":"fn middleware(config &CsrfConfig) vweb.Middleware","name":"middleware","parent_name":"","return_type":"vweb.Middleware","pos":{"len":53,"line_nr":65,"pos":2170,"col":0,"last_line":69},"platform":"cross","kind":"function","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\u0001 set_token returns the csrftoken and sets an encrypted cookie with the hmac of","is_multi":false,"pos":{"len":79,"line_nr":71,"pos":0,"col":0,"last_line":0}},{"text":"\u0001 `config.get_secret` and the csrftoken","is_multi":false,"pos":{"len":39,"line_nr":72,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\vweb\\csrf\\csrf.v","content":"fn set_token(mut ctx vweb.Context, config &CsrfConfig) string","name":"set_token","parent_name":"","return_type":"string","pos":{"len":65,"line_nr":73,"pos":2438,"col":0,"last_line":94},"platform":"cross","kind":"function","public":true,"from_scope":false},{"attributes":{},"comments":[{"text":"\u0001 protect returns false and sends an http 401 response when the csrf verification","is_multi":false,"pos":{"len":81,"line_nr":96,"pos":0,"col":0,"last_line":0}},{"text":"\u0001 fails. protect will always return true if the current request method is in","is_multi":false,"pos":{"len":76,"line_nr":97,"pos":0,"col":0,"last_line":0}},{"text":"\u0001 `config.safe_methods`.","is_multi":false,"pos":{"len":24,"line_nr":98,"pos":0,"col":0,"last_line":0}}],"children":[],"tags":[],"file_path":"D:\\Games\\Proekti\\V\\v\\vlib\\vweb\\csrf\\csrf.v","content":"fn protect(mut ctx vweb.Context, config &CsrfConfig) bool","name":"protect","parent_name":"","return_type":"bool","pos":{"len":61,"line_nr":99,"pos":3309,"col":0,"last_line":153},"platform":"cross","kind":"function","public":true,"from_scope":false}],"generator":"vdoc","time_generated":"2024-02-05 19:45:43"}